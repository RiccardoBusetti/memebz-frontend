(this["webpackJsonpmemebz-frontend"]=this["webpackJsonpmemebz-frontend"]||[]).push([[0],{156:function(e,t,n){e.exports=n(205)},203:function(e,t,n){},205:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(16),i=n.n(o),c=(n(161),n(23)),l=n(136),u=n(42),m=n(26),s=n(137),d=n(133),p=n(6),b=n(17),f=n(56),g=n(256),h=n(242),E=n(261),O=n(239),j=n(11),v=n(257),w=n(58),C=n(132),y=n.n(C),k=n(131),I=n.n(k),M=n(48),V=n(28),x=n(25),S=n(250),$=n(248),D=n(260),N=n(249),F=n(245),Y=n(246),z=n(244),T=n(247),W=n(82),L=n.n(W),R=n(258),B=n(243),U=n(29),q=n.n(U),_=n(134),A=n(122),G=n.n(A);function J(){var e=Object(V.a)(["\n  mutation addMeme($input: AddMemeInput!) {\n    addMeme(input: $input) {\n      id\n    }\n  }\n"]);return J=function(){return e},e}var P=q()(J()),K=Object(O.a)((function(e){return{header:{marginBottom:e.spacing(1),marginTop:e.spacing(1)},progress:{margin:e.spacing(2)}}}));var Z=function(e){var t=K(),n=L()(),o=Object(B.a)(n.breakpoints.down("sm")),i=Object(a.useState)({}),c=Object(b.a)(i,2),l=c[0],u=c[1],m=Object(a.useState)([]),s=Object(b.a)(m,2),d=s[0],p=s[1],f=Object(a.useState)(!1),g=Object(b.a)(f,2),h=g[0],E=g[1],O=Object(x.a)(P,{onCompleted:function(t){e.onDialogClose(!0)}}),j=Object(b.a)(O,2),v=j[0],C=j[1].loading;return r.a.createElement(D.a,{open:e.isOpen,fullScreen:o},r.a.createElement(z.a,null,"Upload a new meme"),r.a.createElement(F.a,null,r.a.createElement(Y.a,null,"To upload a new meme, please fill in the form below and let the fun begin!"),r.a.createElement(T.a,{container:!0,direction:"row",justify:"center",alignItems:"center",spacing:2},h||C?r.a.createElement($.a,{className:t.progress,item:!0,xs:12}):r.a.createElement(r.a.Fragment,null,r.a.createElement(T.a,{item:!0,xs:12},r.a.createElement(w.a,{className:t.header,variant:"body1"},"Give a cool title to your meme:"),r.a.createElement(R.a,{autoFocus:!0,margin:"dense",type:"text",variant:"outlined",fullWidth:!0,onChange:function(e){return u(Object(M.a)({},l,{title:e.target.value}))}})),r.a.createElement(T.a,{item:!0,xs:12},r.a.createElement(w.a,{className:t.header,variant:"body1"},"Choose your (possibly funny) name:"),r.a.createElement(R.a,{autoFocus:!0,margin:"dense",type:"text",variant:"outlined",fullWidth:!0,onChange:function(e){return u(Object(M.a)({},l,{author:e.target.value}))}})),r.a.createElement(T.a,{item:!0,xs:12},r.a.createElement(w.a,{className:t.header,variant:"body1",component:"h2"},"Choose your meme image (pls not too many cats):"),r.a.createElement(_.a,{acceptedFiles:["image/*"],dropzoneText:"Choose your meme file",filesLimit:1,onChange:p}))))),r.a.createElement(N.a,null,h||C?r.a.createElement(r.a.Fragment,null):r.a.createElement(r.a.Fragment,null,r.a.createElement(S.a,{color:"primary",onClick:function(){return e.onDialogClose(!1)}},"Cancel"),d.length>0&&r.a.createElement(S.a,{color:"primary",onClick:function(){E(!0),function(e,t){var n="https://api.cloudinary.com/v1_1/".concat("ddprvzpep","/upload"),a=e.name;G.a.post(n).field("upload_preset","ml_default").field("file",e).field("multiple",!0).field("context",a?"photo=".concat(a):"").end((function(e,n){e||t(n.body)}))}(d[0],(function(e){E(!1),v({variables:{input:Object(M.a)({},l,{imageUrl:e.secure_url})}}),u({}),p([])}))}},"Add meme"))))},H=n(262),Q=n(252),X=n(255),ee=n(253),te=n(254),ne=n(87),ae=n(251),re=n(129),oe=n.n(re),ie=n(128),ce=n.n(ie),le=n(130),ue=n.n(le),me=n(127),se=n.n(me),de=n(135),pe=n(97),be=n.n(pe);function fe(e){var t=function(e){return be.a.unix(parseInt(e)/1e3).format("DD MMM YYYY hh:mm a")}(e);return be()(t,"DD MMM YYYY hh:mm a").fromNow()}var ge=n(88),he=n(263),Ee=n(126),Oe=n.n(Ee);function je(){var e=Object(V.a)(["\n  mutation addCommentOnMeme($input: AddCommentInput!) {\n    addCommentOnMeme(input: $input) {\n      id\n      memeId\n      content\n    }\n  }\n"]);return je=function(){return e},e}function ve(){var e=Object(V.a)(["\n  subscription commentMade($input: CommentInput!) {\n    commentMade(input: $input) {\n      id\n      content\n      dateCommented\n    }\n  }\n"]);return ve=function(){return e},e}function we(){var e=Object(V.a)(["\n  query comments($input: CommentInput!) {\n    comments(input: $input) {\n      id\n      content\n      dateCommented\n    }\n  }\n"]);return we=function(){return e},e}var Ce=q()(we()),ye=q()(ve()),ke=q()(je()),Ie=Object(O.a)((function(e){return{dialogTitle:{display:"flex",justifyContent:"space-between",alignItems:"center"},commentField:{marginStart:e.spacing(1),marginEnd:e.spacing(1)}}}));var Me=function(e){var t=Ie(),n=L()(),o=Object(B.a)(n.breakpoints.down("sm")),i=Object(a.useState)([]),c=Object(b.a)(i,2),l=c[0],u=c[1],m=Object(a.useState)(""),s=Object(b.a)(m,2),d=s[0],p=s[1],f=Object(x.b)(Ce,{variables:{input:{memeId:e.meme.id}},onCompleted:function(e){u([].concat(Object(ge.a)(l),Object(ge.a)(e.comments)))}}).loading,g=Object(x.a)(ke),h=Object(b.a)(g,1)[0];return Object(x.c)(ye,{variables:{input:{memeId:e.meme.id}},onSubscriptionData:function(e){var t=e.subscriptionData.data.commentMade;u([].concat(Object(ge.a)(l),[t]))}}),r.a.createElement(D.a,{open:e.isOpen,fullScreen:o,fullWidth:!0},r.a.createElement(z.a,{className:t.dialogTitle,disableTypography:!0},r.a.createElement(w.a,{variant:"h6"},"Comments"),r.a.createElement(ae.a,{color:"inherit","aria-label":"close",onClick:function(){return e.onDialogClose()}},r.a.createElement(Oe.a,null))),r.a.createElement(F.a,null,r.a.createElement(T.a,{container:!0,direction:"row",justify:"center",alignItems:"center",spacing:2},f?r.a.createElement($.a,{className:t.progress,item:!0,xs:12}):r.a.createElement(r.a.Fragment,null,l.map((function(e){return r.a.createElement(T.a,{item:!0,key:e.id,xs:12},r.a.createElement(T.a,{container:!0,direction:"row",justify:"space-between",alignItems:"flex-end"},r.a.createElement(T.a,{item:!0},r.a.createElement(he.a,{label:e.content,variant:"outlined"})),r.a.createElement(T.a,{item:!0},r.a.createElement(w.a,{variant:"caption"},fe(e.dateCommented)))))}))))),r.a.createElement(N.a,null,r.a.createElement(R.a,{autoFocus:!0,margin:"dense",type:"text",value:d,variant:"outlined",fullWidth:!0,label:"Commment under ".concat(e.meme.title),onChange:function(e){return p(e.target.value)},onKeyPress:function(t){"Enter"===t.key&&(h({variables:{input:{memeId:e.meme.id,content:d}}}),p(""))}})))};function Ve(){var e=Object(V.a)(["\n  subscription downVoteMade($input: VoteInput!) {\n    downVoteMade(input: $input) {\n      id\n      downVotes\n    }\n  }\n"]);return Ve=function(){return e},e}function xe(){var e=Object(V.a)(["\n  subscription upVoteMade($input: VoteInput!) {\n    upVoteMade(input: $input) {\n      id\n      upVotes\n    }\n  }\n"]);return xe=function(){return e},e}function Se(){var e=Object(V.a)(["\n  mutation downVoteMeme($input: VoteInput!) {\n    downVoteMeme(input: $input) {\n      id\n      downVotes\n    }\n  }\n"]);return Se=function(){return e},e}function $e(){var e=Object(V.a)(["\n  mutation upVoteMeme($input: VoteInput!) {\n    upVoteMeme(input: $input) {\n      id\n      upVotes\n    }\n  }\n"]);return $e=function(){return e},e}var De=q()($e()),Ne=q()(Se()),Fe=q()(xe()),Ye=q()(Ve()),ze=Object(O.a)((function(e){return{root:{},media:{height:0,paddingTop:"56.25%"},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},avatar:{backgroundColor:ne.a[500]},commentChip:{margin:8}}}));var Te=function(e){var t=ze(),n=Object(a.useState)(e.meme),o=Object(b.a)(n,2),i=o[0],c=o[1],l=Object(a.useState)(!1),u=Object(b.a)(l,2),m=u[0],s=u[1],d=Object(a.useState)(!1),p=Object(b.a)(d,2),f=p[0],g=p[1],h=Object(x.a)(De),E=Object(b.a)(h,2),O=E[0],j=E[1].loading,v=Object(x.a)(Ne),w=Object(b.a)(v,2),C=w[0],y=w[1].loading;return Object(x.c)(Fe,{variables:{input:{memeId:i.id}},onSubscriptionData:function(e){var t=e.subscriptionData.data.upVoteMade;c(Object(M.a)({},i,{upVotes:t.upVotes}))}}),Object(x.c)(Ye,{variables:{input:{memeId:i.id}},onSubscriptionData:function(e){var t=e.subscriptionData.data.downVoteMade;c(Object(M.a)({},i,{downVotes:t.downVotes}))}}),r.a.createElement(r.a.Fragment,null,r.a.createElement(Q.a,{className:t.root},r.a.createElement(ee.a,{avatar:r.a.createElement(H.a,{className:t.avatar},i.author[0]),action:r.a.createElement(ae.a,{"aria-label":"more"},r.a.createElement(se.a,null)),title:i.author,subheader:fe(i.dateCreated)}),r.a.createElement(te.a,{className:t.media,image:i.imageUrl,onClick:function(){f||g(!0)}}),r.a.createElement(X.a,{disableSpacing:!0},r.a.createElement(ae.a,{"aria-label":"up vote meme",onClick:function(){return O({variables:{input:{memeId:i.id}}})}},j?r.a.createElement($.a,null):i.upVotes,r.a.createElement(ce.a,null)),r.a.createElement(ae.a,{"aria-label":"down vote meme",onClick:function(){return C({variables:{input:{memeId:i.id}}})}},y?r.a.createElement($.a,null):i.downVotes,r.a.createElement(oe.a,null)),r.a.createElement(ae.a,{onClick:function(){return s(!m)},"aria-label":"show comments"},i.lastComments.length,r.a.createElement(ue.a,null)))),f&&r.a.createElement(de.a,{medium:i.imageUrl,showRotate:!1,hideZoom:!0,alt:i.title,onClose:function(){return g(!1)}}),r.a.createElement(Me,{isOpen:m,meme:i,onDialogClose:function(){return s(!1)}}))};function We(){var e=Object(V.a)(["\n  {\n    memes {\n      id\n      title\n      author\n      imageUrl\n      dateCreated\n      upVotes\n      downVotes\n      lastComments(last: 3) {\n        content\n      }\n    }\n  }\n"]);return We=function(){return e},e}var Le=q()(We()),Re=Object(O.a)((function(e){return{root:{padding:16}}}));var Be=function(e){var t=Re(),n=Object(x.b)(Le),a=n.loading,o=n.error,i=n.data,c=n.refetch;return a?"Loading...":o?"Error! ".concat(o):(e.refetch&&c(),r.a.createElement(T.a,{className:t.root,container:!0,direction:"row",justify:"center",alignItems:"center",spacing:2},i.memes.filter((function(t){return""===e.filter||t.title.includes(e.filter)||t.author.includes(e.filter)})).map((function(e){return r.a.createElement(T.a,{item:!0,key:e.id,xs:12,sm:6},r.a.createElement(Te,{meme:e}))}))))},Ue=Object(O.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:Object(f.a)({flexGrow:1,display:"none"},e.breakpoints.up("sm"),{display:"block"}),search:Object(f.a)({position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object(j.c)(e.palette.common.white,.15),"&:hover":{backgroundColor:Object(j.c)(e.palette.common.white,.25)},marginLeft:0,width:"100%"},e.breakpoints.up("sm"),{marginLeft:e.spacing(1),width:"auto"}),searchIcon:{padding:e.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},inputRoot:{color:"inherit"},inputInput:Object(f.a)({padding:e.spacing(1,1,1,0),paddingLeft:"calc(1em + ".concat(e.spacing(4),"px)"),transition:e.transitions.create("width"),width:"100%"},e.breakpoints.up("sm"),{width:"12ch","&:focus":{width:"20ch"}}),fab:{margin:e.spacing.unit,position:"fixed",bottom:e.spacing(2),right:e.spacing(2)}}}));var qe=function(){var e=Ue(),t=Object(a.useState)(!1),n=Object(b.a)(t,2),o=n[0],i=n[1],c=Object(a.useState)(!1),l=Object(b.a)(c,2),u=l[0],m=l[1],s=Object(a.useState)(""),d=Object(b.a)(s,2),p=d[0],f=d[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(g.a,{position:"static"},r.a.createElement(v.a,null,r.a.createElement(w.a,{className:e.title,variant:"h6",noWrap:!0},"MemeBz"),r.a.createElement("div",{className:e.search},r.a.createElement("div",{className:e.searchIcon},r.a.createElement(I.a,null)),r.a.createElement(E.a,{placeholder:"Search\u2026",classes:{root:e.inputRoot,input:e.inputInput},inputProps:{"aria-label":"search"},onChange:function(e){return f(e.target.value)}})))),r.a.createElement(Be,{filter:p,refetch:u}),r.a.createElement(Z,{isOpen:o,onDialogClose:function(e){i(!1),m(e)}}),r.a.createElement(h.a,{className:e.fab,color:"secondary","aria-label":"edit",onClick:function(e){return i(!0)}},r.a.createElement(y.a,null)))},_e=new s.a({uri:"https://memebz.herokuapp.com/graphql"}),Ae=new d.a({uri:"wss://memebz.herokuapp.com/graphql",options:{reconnect:!0}}),Ge=Object(m.d)((function(e){var t=e.query,n=Object(p.l)(t);return"OperationDefinition"===n.kind&&"subscription"===n.operation}),Ae,_e),Je=new u.a({link:Ge,cache:new l.a});var Pe=function(){return r.a.createElement(c.a,{client:Je},r.a.createElement(qe,null))};n(203),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Pe,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[156,1,2]]]);
//# sourceMappingURL=main.ee53c4ea.chunk.js.map